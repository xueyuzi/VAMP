<script src="agent.component.ts"></script>
<nb-card>
  <nb-card-header>
    采集器配置
  </nb-card-header>

  <nb-card-body>
    <button nbButton style="margin:10px 0" (click)="showNew()">新建</button>
    <ng2-smart-table [source]="agentSource" [settings]="settings" (userRowSelect)="showEdit($event)"
      (deleteConfirm)="delUser($event)"></ng2-smart-table>
  </nb-card-body>
</nb-card>
<p-dialog header="采集器配置" [(visible)]="isEdit" [draggable]="true" [resizable]="false">
  <nb-accordion class="expaned">
    <nb-accordion-item *ngFor="let ikey of objectKeys(agentConfig)">
      <nb-accordion-item-header>{{ikey}}</nb-accordion-item-header>
      <nb-accordion-item-body>
        <div *ngFor="let okey of objectKeys(agentConfig[ikey])">
          <div class="setting-item">
            <label>{{okey}}</label>
            <span>{{agentConfig[ikey][okey]}}</span>
          </div>
        </div>
      </nb-accordion-item-body>
    </nb-accordion-item>
  </nb-accordion>
  <div class="setting-container" *ngIf="user!==undefined">
    <div class="setting-item">
      <label>名称:</label>
      <input type="text" nbInput [(ngModel)]="user.agentName" fullWidth>
    </div>

    <div class="setting-item">
      <label>IP地址:</label>
      <input type="text" nbInput [(ngModel)]="user.agentAddress" fullWidth>
    </div>

    <div class="setting-item">
      <label>识别key:</label>
      <input type="text" nbInput [(ngModel)]="user.agentKey" fullWidth>
    </div>
    <div class="setting-item">
      <label>脱敏规则配置:</label>
      <nb-select multiple placeholder="请选脱敏规则配置" [(selected)]="user.desen_rule_id"
        (selectedChange)="changeDesen($event)" style="width: 200px">
        <nb-option [value]="role.id" *ngFor="let role of dRuleList">{{role.desenName}}</nb-option>
      </nb-select>
    </div>
  </div>
  <button nbButton (click)="saveUser()" style="margin: 10px;">保存</button>
  <button nbButton status="info" (click)="showCharts()" style="margin: 10px;">查看图表</button>
</p-dialog>


<p-dialog header="图表" [(visible)]="isShowCharts" [draggable]="true" [resizable]="false">
  <div style="width:800px;height:700px;">
    <div style="width:400px;height:300px;float: left;">
      <div echarts [options]="chartOptions1" style="height:100%;width:100%">
      </div>
    </div>
    <div style="width:400px;height:300px;float: left;">
      <div echarts [options]="chartOptions2" style="height:100%;width:100%">
      </div>
    </div>
    <div style="width:400px;height:300px;float: left;">
      <div echarts [options]="chartOptions1" style="height:100%;width:100%">
      </div>
    </div>
    <div style="width:400px;height:300px;float: left;">
      <div echarts [options]="chartOptions2" style="height:100%;width:100%">
      </div>
    </div>
  </div>
</p-dialog>
